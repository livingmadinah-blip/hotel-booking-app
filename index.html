<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hotel Booking</title>
<style>
body { font-family: Arial; padding: 10px; }
input, select, button { width: 100%; margin: 6px 0; padding: 10px; }
button { background: #2e7d32; color: white; border: none; }
.list { margin-top: 20px; }
.card { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
</style>
</head>
<body>

<h2>Hotel Booking</h2>

<input id="guest" placeholder="Guest Name">
<select id="room">
  <option>301</option><option>302</option><option>303</option>
  <option>304</option><option>305</option><option>306</option>
  <option>307</option><option>314</option><option>315</option>
  <option>316</option>
</select>

<input type="date" id="checkin">
<input type="date" id="checkout">
<input type="number" id="rate" placeholder="Rate per night">

<button onclick="save()">Save Booking</button>

<div class="list" id="list"></div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxl2Ehzv5q6zlVI7hIFVSO9-At6XrVVOddsr9alsuM36Ni795Z2yqFgemx5TTjuigdH/exec";
let editId = null;

function save() {
  const data = {
    action: editId ? "update" : "create",
    id: editId,
    guest: guest.value,
    room: room.value,
    checkin: checkin.value,
    checkout: checkout.value,
    rate: rate.value
  };

  fetch(API, {
    method: "POST",
    body: JSON.stringify(data)
  }).then(r => r.json()).then(res => {
    alert(res.message || res.status);
    editId = null;
    load();
  });
}

function load() {
  fetch(API, {
    method: "POST",
    body: JSON.stringify({ action: "list" })
  }).then(r => r.json()).then(rows => {
    list.innerHTML = "";
    rows.forEach(r => {
      list.innerHTML += `
        <div class="card">
          <b>${r[1]}</b> – Room ${r[2]}<br>
          ${r[3]} → ${r[4]}<br>
          <button onclick="edit('${r[0]}')">Edit</button>
          <button onclick="del('${r[0]}')">Delete</button>
        </div>`;
    });
  });
}

function edit(id) {
  editId = id;
  alert("Edit loaded – update fields and save");
}

function del(id) {
  if (!confirm("Delete booking?")) return;
  fetch(API, {
    method: "POST",
    body: JSON.stringify({ action: "delete", id })
  }).then(() => load());
}

load();
</script>

</body>
</html>
